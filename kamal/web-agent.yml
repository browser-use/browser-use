# Name of your application. Used to uniquely configure containers.
minimum_version: 2.6.1
service: web-agent
primary_role: web
# Name of the container image.
image: staging/web-agent

registry:
  server: 653584809203.dkr.ecr.ap-southeast-1.amazonaws.com
  username: AWS
  password: <%= %x(aws ecr get-login-password --region ap-southeast-1) %>


# Configure builder setup.
builder:
  arch: amd64
  args:
    ENV: staging
  dockerfile: Dockerfile

proxy:
  app_port: 8765
  healthcheck:
    path: /
    interval: 10
    timeout: 30

# Inject ENV variables into containers (secrets come from .kamal/secrets).
env:
  secret:
    - AZURE_OPENAI_API_KEY
    - AZURE_OPENAI_ENDPOINT
  clear:
    PORT: 8765